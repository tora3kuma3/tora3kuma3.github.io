自力では無理と判断し、解説を読み込んだ上でC++のソースをPythonにコンバートした。
パフォーマンス調整前はサーバ上で20秒以上かかるようでランタイムエラーとなった。
kernprofでパフォーマンス調整し手元のPCで180秒から60秒程度に。
単純にコンバートするだけでも難しいな。
Python遅すぎ・・・
